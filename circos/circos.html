<html>
	<head>
		<title>	Circos Plots</title>
		<script type="text/javascript" src="circos.js"></script>
		<script type="text/javascript" src="DataSet.js"></script>
	</head>
	<body>
		<canvas id="circosPlot" width=500 height=500 />
			<script type="text/javascript">
				"use strict";
				
				/*dingdingSound = document.createElement("embed");
				dingdingSound.setAttribute("src", "dingding.wav");
    			dingdingSound.setAttribute("hidden", true);
    			dingdingSound.setAttribute("autostart", true);
		    	document.body.appendChild(dingdingSound);

				clickSound = document.createElement("embed");
				clickSound.setAttribute("src", "dingding.wav");
    			clickSound.setAttribute("hidden", true);
    			clickSound.setAttribute("autostart", false);
		    	document.body.appendChild(clickSound);*/
				
				/* set up plot */
				var canvas = document.getElementById("circosPlot");
				var canvasContext = canvas.getContext("2d");
				var ds = {
					innerArcThickness: 5.0,
					innerTextOffset: 5,
					groupNames: ["Group A", "Group B", "Group C"],
					groupEnd: [1, 3, 5],
					colorScheme: ["blue", "rgba(100%, 25%, 100%, .5)", "rgba(100%, 0, 0, .5)", "rgba(100%, 100%, 0%, .5)", "rgba(100%, 0%, 100%, .5)"],
					splineOutline: "black",
					sweeps: [0.78539816339744830961566084581988, 1.0471975511965977461542144610932, .75, .75, .75, .75],
					labels: ["test0", "test1", "test2", "test3", "empty1", "empty2"],
					dist: 100,
					data1: [2, 1, 2, 3, 1],
					data2: [1, 0, 0, 1, 4],
					type : [1, 2, 3, 4, 0]
				};
				var fireworks = {
					colorScheme: ["rgba(100%, 0%, 0%, .5)", "rgba(100%, 50%, 0%, .5)", "rgba(100%, 100%, 0%, .5)", "rgba(0%, 100%, 0%, .5)", "rgba(0%, 0%, 100%, .5)"],
					splineOutline: "black",
					dist:300,
					groupNames: ["Group 1"],
					groupEnd: [299],
					thin: true,
					labels: ["", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
					numSweeps: 300,
					data1: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
					data2: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299],
					type: [1, 0, 0, 0, 2, 1, 3, 2, 1, 1, 1, 3, 2, 3, 2, 1, 1, 0, 2, 4, 4, 2, 1, 1, 1, 3, 3, 2, 1, 4, 1, 3, 3, 2, 4, 2, 1, 2, 1, 3, 1, 3, 0, 1, 0, 2, 3, 2, 1, 1, 3, 1, 0, 3, 2, 2, 4, 1, 2, 1, 0, 0, 2, 1, 0, 3, 3, 1, 0, 3, 4, 1, 3, 3, 2, 4, 3, 4, 2, 1, 2, 3, 4, 1, 4, 1, 2, 4, 3, 2, 2, 1, 1, 3, 3, 2, 3, 2, 1, 2, 2, 2, 2, 4, 0, 2, 1, 3, 3, 0, 3, 3, 1, 4, 4, 3, 4, 0, 1, 2, 0, 2, 0, 3, 4, 1, 2, 2, 0, 4, 1, 4, 4, 3, 2, 1, 1, 0, 3, 1, 1, 1, 3, 2, 0, 1, 0, 0, 3, 3, 2, 0, 1, 2, 4, 1, 2, 2, 4, 2, 3, 3, 2, 0, 3, 1, 2, 1, 4, 2, 0, 3, 3, 4, 3, 2, 1, 3, 2, 1, 1, 3, 3, 4, 3, 2, 1, 4, 3, 2, 3, 2, 2, 3, 1, 3, 1, 2, 1, 3, 0, 4, 3, 4, 3, 4, 4, 3, 3, 3, 2, 3, 4, 2, 2, 3, 2, 1, 4, 1, 3, 1, 2, 1, 1, 1, 2, 4, 2, 1, 1, 1, 1, 0, 4, 0, 3, 3, 2, 3, 2, 1, 3, 4, 3, 2, 1, 4, 3, 3, 2, 3, 0, 1, 3, 0, 1, 0, 2, 3, 4, 3, 3, 1, 2, 2, 4, 1, 3, 3, 2, 2, 2, 4, 2, 4, 3, 2, 2, 0, 2, 2, 2, 2, 3, 1, 1, 2, 2, 4, 2, 0, 3, 1, 1, 1, 3, 2, 3]
				};
				var circos = new Circos(fireworks);
				circos.render(canvasContext, {
					x: canvas.clientWidth / 2,
					y: canvas.clientHeight / 2
				}, canvas.clientWidth, canvas.clientHeight);
				function setUpFF(){
					
					/* set up mouse events for FF. Please switch away from IE */
					var mouseIsDown = false;
					var lastPosition = null;
					function mouseMoved(evt){
						var position = {x:evt.clientX - canvas.offsetLeft, y:evt.clientY - canvas.offsetTop};
						if(mouseIsDown){
							if(lastPosition == null){ //this should never happen
								lastPosition = position;
							}
							var x = lastPosition.x - position.x;
							var y = lastPosition.y - position.y;
							lastPosition = position;
							circos.handleMouseDrag(canvasContext, position, x, y);
						} else {
							circos.handleMouseOver(canvasContext, position);
						}
					}
					
					function mouseUp(evt){
						mouseIsDown = false;
					}
					
					function mouseDown(evt){
						lastPosition = {x:evt.clientX - canvas.offsetLeft, y:evt.clientY - canvas.offsetTop};
						mouseIsDown = true;
						circos.handleMouseDown(canvasContext, lastPosition);
					}
					
					function mouseScroll(evt){
						wheelDelta = evt.detail ? evt.detail : evt.wheelData;
						circos.handleMouseWheel(canvasContext, wheelDelta);
					}
					
					/* assign events */
					
					canvas.onmousedown = mouseDown;
					canvas.onmouseup = mouseUp;
					canvas.onmousemove = mouseMoved;
					
	
					/* From http://www.javascriptkit.com/javatutors/onmousewheel.shtml */
	
					var mousewheelevt=(/Firefox/i.test(navigator.userAgent))? "DOMMouseScroll" : "mousewheel" //FF doesn't recognize mousewheel as of FF3.x
	 
					if (canvas.attachEvent) //if IE (and Opera depending on user setting)
					    canvas.attachEvent("on"+mousewheelevt, mouseScroll)
					else if (canvas.addEventListener) //WC3 browsers
					    canvas.addEventListener(mousewheelevt, mouseScroll, false)
					    
					return true;
				}
				
				//TODO: later
				function setUpMobileSafari(){
					var center = {x:250, y:250};
					var oldTouches;
					
					function touchStart(evt){
						oldTouches = evt.touches;
					}
					
					function touchMove(evt){
						if(evt.touches.length == 1){
							var x = oldTouches[0].pageX - evt.touches[0].pageX;
							var y = oldTouches[0].pageY - evt.touches[0].pageY;
							center.x -= x;
							center.y -= y;
						} else if (evt.touches.length == 2){
							var detailShift = 0;
							var x0 = oldTouches[0].pageX - evt.touches[0].pageX;
							var y0 = oldTouches[0].pageY - evt.touches[0].pageY;
							var x1 = oldTouches[1].pageX - evt.touches[1].pageX;
							var y1 = oldTouches[1].pageY - evt.touches[1].pageY;
							if(evt.touches[0].pageX > evt.touches[1].pageX){
								if(x0 > 0){ /* away */
									/* zoom in */
									ds.dist += Math.abs(x0) + Math.abs(x1);
								} else if (x0 < 0){ /* togeather */
									ds.dist -= Math.abs(x0) + Math.abs(x1);
								}
							} else {
								if(x1 > 0){ /* away */
									/* zoom in */
									ds.dist += Math.abs(x0) + Math.abs(x1);
								} else if (x1 < 0){ /* togeather */
									ds.dist -= Math.abs(x0) + Math.abs(x1);
								}
							}
							if(evt.touches[0].pageY > evt.touches[1].pageY){
								if(y0 > 0){ /* away */
									/* zoom in */
									ds.dist += Math.abs(y0) + Math.abs(y1);
								} else if (y0 < 0){ /* togeather */
									ds.dist -= Math.abs(y0) + Math.abs(y1);
								}
							} else {
								if(y1 > 0){ /* away */
									/* zoom in */
									ds.dist += Math.abs(y0) + Math.abs(y1);
								} else if (y1 < 0){ /* togeather */
									ds.dist -= Math.abs(y0) + Math.abs(y1);
								}
							}
							
							/* render */
							circos.render(canvasContext, center, ds.dist);
						}
					}
					
					function touchEnd(evt){
						touches = null;
					}
					
					function touchCancel(evt){
						touches = null;
					}
					
					element.addEventListener("touchstart", touchStart, false);
					element.addEventListener("touchmove", touchMove, false);
					element.addEventListener("touchend", touchEnd, false);
					element.addEventListener("touchcancel", touchCancel, false)
				}
				if((navigator.userAgent.match(/iPhone/i)) || (navigator.userAgent.match(/iPod/i))) {
					setUpMobileSafari();
				} else {
					setUpFF();
				}
			</script>
	</body>
</html>